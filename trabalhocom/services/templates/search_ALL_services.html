{% extends "base.html" %}
{% block content %}

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" style="background-color: #23272b" id="mainNav">
        <div class="container">
            <a class="navbar-brand js-scroll-trigger" href="{% url 'core:home' %}">Home</a>
            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
                    data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
                    aria-label="Toggle navigation">Menu<i class="fa fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ml-auto">

                    <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="{% url 'core:home' %}#about">Sobre</a>
                    </li>
                    {% if user.is_authenticated %}
                        <li class="nav-item">
                            <a class="nav-link js-scroll-trigger" href="{% url 'accounts:dashboard' %}">Painel</a>
                        </li>
                    {% endif %}
                    <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="{% url 'core:home' %}#team">Equipe</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="{% url 'core:home' %}#contact">Contato</a>
                    </li>
                    {% if user.is_authenticated %}
                        <li class="nav-item">
                            <a class="nav-link js-scroll-trigger" href="{% url 'accounts:logout' %}">Sair</a>
                        </li>

                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link js-scroll-trigger" href="{% url 'accounts:register' %}">Cadastrar</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link js-scroll-trigger" href="" data-toggle="modal"
                               data-target="#login">Login</a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <div class="row" style="background-color: white">
        <div class="col-md-3 justify-content-md-center" style="background-color: whitesmoke; padding-top: 150px">
            <div class="container">

                <div class="row justify-content-md-center text-center">
                    <h4 class="section-heading">Buscar</h4>
                </div>

                <form method="post">
                    {% csrf_token %}
                    <div class="form-row justify-content-center">
                        <div class="form-group col-md-12">
                            <label>Descrição</label>
                            <input type="text" name="username" class="form-control">
                        </div>
                    </div>
                    <div class="form-row justify-content-center">
                        <div class="form-group col-md-12">
                            <label>Categoria</label>
                            <select class="form-control" name="">
                                <option value="" selected>Selecione ...</option>
                                <option value=""></option>
                                <option value=""></option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row justify-content-center">
                        <div class="form-group col-md-12">
                            <label>Estado</label>
                            <select id="estados" class="form-control" name="estado">
                                <option value="" selected>Selecione um estado...</option>
                                {% for estado in estados %}
                                    <option value="{{ estado.uf }}">{{ estado.nome }}</option>
                                {% endfor %}
                            </select>
                        </div>

                    </div>
                    <div class="form-row justify-content-center">
                        <div class="form-group col-md-12">
                            <label>Cidade</label>
                            <select id="cidades" class="form-control" name="cidade" disabled></select>
                        </div>
                    </div>
                    <div class="form-row justify-content-center">
                        <button type="submit" class="btn btn-primary">Filtrar</button>
                    </div>
                    <br><br><br><br>
                </form>

            </div>

        </div>

        <div class="col-md-9">
            <section>
                <div class="container">
                    <div class="row justify-content-md-center">
                        <div class="col-md-12 text-center">
                            <h2 class="section-heading">Serviços Listados</h2>
                            <br>
                        </div>
                    </div>
                </div>
                {% block busca_content %}
                    {% for servico in servicos %}
                        <div class="row justify-content-md-center">
                            <div class="col-md-3" style="background-color: white">
                                <div class="row">
                                    <h6 class="font-italic">
                                        {{ servico.usuario }}
                                    </h6>
                                </div>
                                <br>
                                <div class="row">
                                    <p>
                                        {{ servico.usuario.cidade }} / {{ servico.usuario.estado }}
                                    </p>
                                </div>
                            </div>

                            <div class="col-md-5" style="background-color: white">
                                <div class="row">
                                    <h6 class="section-subheading">
                                        {{ servico.descricao_servico }}
                                    </h6>
                                </div>
                                <br>
                                <div class="row">
                                    <h6 class="section-subheading" style="color: #bd2130">
                                        Valor: {{ servico.valor }}
                                    </h6>
                                </div>
                            </div>

                            <div class="col-md-3 justify-content-md-center" style="background-color: white">
                                <a class="btn btn-link js-scroll-trigger" href="#">Mais detalhes</a>

                            </div>

                            <br>
                            <hr size="10" width="90%">
                            <br>

                        </div>
                    {% empty %}
                        <div class="row justify-content-md-center">
                            <div class="col-md-12 text-center">
                                <p>Nenhum serviço cadastrado</p>
                            </div>
                        </div>
                    {% endfor %}
                {% endblock %}

            </section>
        </div>
    </div>

    <!-- Modal -->
    <div id="login" class="modal fade bs-example-modal-md" role="dialog">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <form class="form-horizontal text-center" action="{% url 'accounts:login' %}" method="post">
                        {% csrf_token %}

                        <div class="container">

                            <div class="col-sm-10-">
                                <label>Email</label>
                                {#                                <input type="text" name="username" class="form-control text-center">#}
                                {{ form_login.email }}
                            </div>
                            <div class="col-sm-10-">
                                <label>Senha</label>
                                {#                                <input type="password" name="password" class="form-control text-center">#}
                                {{ form_login.password }}
                            </div>
                            <br>
                            <div class="col-sm-4-">
                                <button type="submit" class="btn btn-info">Entrar</button>
                            </div>
                            <p>
                                <a href="{% url 'accounts:register' %}" title="">Não sou cadastrado</a><br/>
                                <a href="{% url 'accounts:password_reset' %}" title="">Esqueci minha senha</a><br/>
                            </p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block scripts %}
    <script>
        $("#estados").change(function () {
            var uf = $(this).val();

            $.ajax({
                url: '/conta/get_cidades/' + uf,
                dataType: 'json',
                success: function (dataReturn) {
                    $("#cidades").html(dataReturn.cidades);
                    document.getElementById("cidades").disabled = false;
                }
            });
        });
    </script>
{% endblock %}